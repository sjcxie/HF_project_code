---
title: "GBTM_data_without_imputation"
author: "Jinchen Xie"
date: "6/10/2020"
output: html_document
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
library(tidyverse)
library(knitr)
library(readxl)
library(openxlsx)
library(data.table)
library(Hmisc)
library(kader)
```

# import admission dataset

The dataset used is admission withou 30% NA tolerance. 
```{r}
admission_30NA <- read_excel("~/Desktop/datasets/processed/Filtered Attributes Admission.xlsx", sheet = 'NA2030_filtered_admission')
```

We are only interested in the continuous lab measurements here. **New dataset: admission_lab**
```{r}
names(admission_30NA)[names(admission_30NA) == "READMISSION_DAYS"] <- "DAYS_READMISSION"

admission_lab <- 
  select(admission_30NA, -ends_with("_DAYS")) %>% 
  select(rID, DAYS_READMISSION, WBC:GLUCOSE)

names(admission_lab)[names(admission_lab) == "NA"] <- "N_A"

admission_lab$DAYS_READMISSION[which(is.na(admission_lab$DAYS_READMISSION))] <- 0
```


```{r}
summary(admission_lab)
```


# Examine the correlation
```{r}
rcorr(as.matrix(admission_lab))$r
```
*There seem to be high correlation (-0.628) between CR and EGFR. But not highly correlated (0.7-0.9). *


# Deal with outliers and skewness

## WBC
```{r}
measure = "WBC"
admission.wbc <- admission_lab
summary(admission_lab[[measure]])
```

*There are definitely outliers we want to remove.*
### Remove outliers
```{r eliminate outliers}
iqr <- IQR(admission_lab[[measure]], na.rm = TRUE)
Q <- quantile(admission_lab[[measure]], probs=c(0.25, 0.75), na.rm = TRUE)
admission.wbc[[measure]][which((admission_lab[[measure]] <  (Q[1] - 1.5*iqr)) | (admission_lab[[measure]] > (Q[2]+3*iqr)))] <- NA_real_
```


```{r}
ggplot(data = admission.wbc, aes(WBC)) + geom_histogram()
```
*The data appeared to be positively skewed.*


### log transformation
```{r}
admission.wbc[[measure]] <- sqrt(admission.wbc[[measure]])
```

```{r}
ggplot(data = admission.wbc, aes(WBC)) + geom_histogram()
```

### transform to censored data
```{r}
temp <- admission.wbc
admission_lab.updated <- admission.wbc
# cuts <- c(2, 2.25, 2.5, 2.75, 3, 3.25, 3.5, 3.75, 4)
cuts <- seq(2, 4.2, 0.275)

for (val in seq(1,length(cuts))){
  if (val==1){
    admission_lab.updated[[measure]][which(temp[[measure]] <= cuts[val])] <- 0
  } else if (val==length(cuts)){
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val-1] & temp[[measure]] <= cuts[val])] <- val-1
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val])] <- val
  } else{
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val-1] & temp[[measure]] <= cuts[val])] <- val-1
  }
}

```

```{r}
admission_lab <- admission_lab.updated
```

## HGB

```{r}
measure = "HGB"
admission.hgb <- admission_lab
summary(admission_lab[[measure]])
ggplot(data = admission.hgb, aes(HGB)) + geom_histogram()
```

*It looks like HGB doesn't need any transformation.*

### transform to censored data
```{r}
temp <- admission.hgb
admission_lab.updated <- admission.hgb
# cuts <- c(7, 8, 9, 10, 3, 3.25, 3.5, 3.75, 4)
cuts <- seq(7, 16, 1.125)

for (val in seq(1,length(cuts))){
  if (val==1){
    admission_lab.updated[[measure]][which(temp[[measure]] <= cuts[val])] <- 0
  } else if (val==length(cuts)){
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val-1] & temp[[measure]] <= cuts[val])] <- val-1
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val])] <- val
  } else{
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val-1] & temp[[measure]] <= cuts[val])] <- val-1
  }
}
```

```{r}
admission_lab <- admission_lab.updated
```


## CR

```{r}
measure = "CR"
admission.cr <- admission_lab
summary(admission_lab[[measure]])
# ggplot(data = admission.cr, aes(CR)) + geom_histogram()
```

*There seem to be outliers in CR measurements.*

### Remove outliers
```{r eliminate outliers}
iqr <- IQR(admission_lab[[measure]], na.rm = TRUE)
Q <- quantile(admission_lab[[measure]], probs=c(0.25, 0.75), na.rm = TRUE)
admission.cr[[measure]][which((admission_lab[[measure]] <  (Q[1] - 1.5*iqr)) | (admission_lab[[measure]] > (Q[2]+6*iqr)))] <- NA_real_
```


```{r}
ggplot(data = admission.cr, aes(CR)) + geom_histogram()
```


### log transformation
```{r}
admission.cr[[measure]] <- kader:::cuberoot(admission.cr[[measure]])
admission.cr[[measure]] <- kader:::cuberoot(admission.cr[[measure]])
```

```{r}
ggplot(data = admission.cr, aes(CR)) + geom_histogram()
```
### transform to censored data
```{r}
temp <- admission.cr
admission_lab.updated <- admission.cr
# cuts <- c(7, 8, 9, 10, 3, 3.25, 3.5, 3.75, 4)
cuts <- seq(0.95, 1.25, 0.0375)

for (val in seq(1,length(cuts))){
  if (val==1){
    admission_lab.updated[[measure]][which(temp[[measure]] <= cuts[val])] <- 0
  } else if (val==length(cuts)){
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val-1] & temp[[measure]] <= cuts[val])] <- val-1
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val])] <- val
  } else{
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val-1] & temp[[measure]] <= cuts[val])] <- val-1
  }
}
```

```{r}
admission_lab <- admission_lab.updated
```


## checkpoint 1
```{r}
admission.lab.v2 <- admission_lab


# admission_lab <- admission.lab.v2
```



## EGFR
```{r}
measure = "EGFR"
admission.egfr <- admission_lab
summary(admission_lab[[measure]])
# ggplot(data = admission.egfr, aes(EGFR)) + geom_histogram()
```
*There are outliers to be removed.*

### Remove outliers
```{r eliminate outliers}
iqr <- IQR(admission_lab[[measure]], na.rm = TRUE)
Q <- quantile(admission_lab[[measure]], probs=c(0.25, 0.75), na.rm = TRUE)
admission.egfr[[measure]][which((admission_lab[[measure]] <  (Q[1] - 1.5*iqr)) | (admission_lab[[measure]] > (Q[2]+2*iqr)))] <- NA_real_
```


```{r}
ggplot(data = admission.egfr, aes(EGFR)) + geom_histogram()
```


### log transformation
```{r}
admission.egfr[[measure]] <- kader:::cuberoot(admission.egfr[[measure]])
```

```{r}
ggplot(data = admission.egfr, aes(EGFR)) + geom_histogram()
```

### transform to censored data
```{r}
temp <- admission.egfr
admission_lab.updated <- admission.egfr
# cuts <- c(2, 2.25, 2.5, 2.75, 3, 3.25, 3.5, 3.75, 4)
cuts <- seq(1.8, 5, 0.4)

for (val in seq(1,length(cuts))){
  if (val==1){
    admission_lab.updated[[measure]][which(temp[[measure]] <= cuts[val])] <- 0
  } else if (val==length(cuts)){
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val-1] & temp[[measure]] <= cuts[val])] <- val-1
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val])] <- val
  } else{
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val-1] & temp[[measure]] <= cuts[val])] <- val-1
  }
}

```

```{r}
admission_lab <- admission_lab.updated
```


## K
```{r}
measure = "K"
admission.k <- admission_lab
summary(admission_lab[[measure]])
# ggplot(data = admission.k, aes(K)) + geom_histogram()
```
### log transformation
```{r}
admission.k[[measure]] <- log10(admission.k[[measure]])
```

```{r}
ggplot(data = admission.k, aes(K)) + geom_histogram()
```


### transform to censored data
```{r}
temp <- admission.k
admission_lab.updated <- admission.k
# cuts <- c(0.5, 0.54, 0.55, 0.575, 0.6, 3.25, 3.5, 3.75, 4)
cuts <- seq(0.46, 0.78, 0.04)

for (val in seq(1,length(cuts))){
  if (val==1){
    admission_lab.updated[[measure]][which(temp[[measure]] <= cuts[val])] <- 0
  } else if (val==length(cuts)){
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val-1] & temp[[measure]] <= cuts[val])] <- val-1
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val])] <- val
  } else{
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val-1] & temp[[measure]] <= cuts[val])] <- val-1
  }
}

```

```{r}
admission_lab <- admission_lab.updated
```


## checkpoint 2
```{r}
admission.lab.v3 <- admission_lab


# admission_lab <- admission.lab.v3
```



## N_A
```{r}
measure = "N_A"
admission.na <- admission_lab
summary(admission_lab[[measure]])
# ggplot(data = admission.na, aes(N_A)) + geom_histogram()
```

```{r}
ggplot(data = admission.na, aes(N_A)) + geom_histogram()
```

### transform to censored data
```{r}
temp <- admission.na
admission_lab.updated <- admission.na
# cuts <- c(2, 2.25, 2.5, 2.75, 3, 3.25, 3.5, 3.75, 4)
cuts <- seq(125, 145, 2.5)

for (val in seq(1,length(cuts))){
  if (val==1){
    admission_lab.updated[[measure]][which(temp[[measure]] <= cuts[val])] <- 0
  } else if (val==length(cuts)){
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val-1] & temp[[measure]] <= cuts[val])] <- val-1
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val])] <- val
  } else{
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val-1] & temp[[measure]] <= cuts[val])] <- val-1
  }
}

```

```{r}
admission_lab <- admission_lab.updated
```

## GLUCOSE
```{r}
measure = "GLUCOSE"
admission.glucose <- admission_lab
summary(admission_lab[[measure]])
# ggplot(data = admission.glucose, aes(GLUCOSE)) + geom_histogram()
```
*There are outliers to be removed.*
### Remove outliers
```{r eliminate outliers}
iqr <- IQR(admission_lab[[measure]], na.rm = TRUE)
Q <- quantile(admission_lab[[measure]], probs=c(0.25, 0.75), na.rm = TRUE)
admission.glucose[[measure]][which((admission_lab[[measure]] <  (Q[1] - 1.5*iqr)) | (admission_lab[[measure]] > (Q[2]+2*iqr)))] <- NA_real_
```


```{r}
ggplot(data = admission.glucose, aes(GLUCOSE)) + geom_histogram()
```
### log transformation
```{r}
admission.glucose[[measure]] <- log10(admission.glucose[[measure]])
```

```{r}
ggplot(data = admission.glucose, aes(GLUCOSE)) + geom_histogram()
```

### transform to censored data
```{r}
temp <- admission.glucose
admission_lab.updated <- admission.glucose
# cuts <- c(2, 2.25, 2.5, 2.75, 3, 3.25, 3.5, 3.75, 4)
cuts <- seq(1.7, 2.55, 0.1)

for (val in seq(1,length(cuts))){
  if (val==1){
    admission_lab.updated[[measure]][which(temp[[measure]] <= cuts[val])] <- 0
  } else if (val==length(cuts)){
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val-1] & temp[[measure]] <= cuts[val])] <- val-1
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val])] <- val
  } else{
    admission_lab.updated[[measure]][which(temp[[measure]] > cuts[val-1] & temp[[measure]] <= cuts[val])] <- val-1
  }
}

```

```{r}
admission_lab <- admission_lab.updated
```


## checkpoint 3
```{r}
admission.lab.v4 <- admission_lab


# admission_lab <- admission.lab.v4
```


# only >=3 readmissions
```{r}
readmission_counts <- admission_lab %>% group_by(rID) %>% tally()
sub_3to15_rID <- readmission_counts[which(readmission_counts$n>2),]$rID

admission_lab.3to15 <- admission_lab[which(admission_lab$rID %in% sub_3to15_rID),]
```


# allow missing at random
```{r}
list_remove <- c()
for (id in sub_3to15_rID){
  sub.df <- admission_lab.3to15[which(admission_lab.3to15$rID == id),]
  num_wbc <- dim(sub.df[-which(is.na(sub.df$WBC)),])[1]
  na_wbc <- dim(sub.df[which(is.na(sub.df$WBC)),])[1]
  num_hgb <- dim(sub.df[-which(is.na(sub.df$HGB)),])[1]
  na_hgb <- dim(sub.df[which(is.na(sub.df$HGB)),])[1]
  num_cr <- dim(sub.df[-which(is.na(sub.df$CR)),])[1]
  na_cr <- dim(sub.df[which(is.na(sub.df$CR)),])[1]
  num_egfr <- dim(sub.df[-which(is.na(sub.df$EGFR)),])[1]
  na_egfr <- dim(sub.df[which(is.na(sub.df$EGFR)),])[1]
  num_k <- dim(sub.df[-which(is.na(sub.df$K)),])[1]
  na_k <- dim(sub.df[which(is.na(sub.df$K)),])[1]
  num_na <- dim(sub.df[-which(is.na(sub.df$N_A)),])[1]
  na_na <- dim(sub.df[which(is.na(sub.df$N_A)),])[1]
  num_glucose <- dim(sub.df[-which(is.na(sub.df$GLUCOSE)),])[1]
  na_glucose <- dim(sub.df[which(is.na(sub.df$GLUCOSE)),])[1]
  if (((num_wbc<3) & (na_wbc!=0)) | ((num_hgb<3) & (na_hgb!=0)) | ((num_cr<3) & (na_cr!=0)) | ((num_egfr<3) & (na_egfr!=0)) |  ((num_k<3) & (na_k!=0)) | ((num_na<3) & (na_na!=0)) | ((num_glucose<3) & (na_glucose!=0))){
    list_remove <- append(list_remove, id)
  }else{
    next
  }
}

```

```{r}
admission_lab.NArandom <- admission_lab.3to15[-which(admission_lab.3to15$rID %in% list_remove),]
chosen_rID <- admission_lab.NArandom$rID
```

# remove all with missing values
```{r}
na.rid.1 <- dplyr::union(admission_lab.3to15[which(is.na(admission_lab.3to15$WBC)),]$rID, admission_lab.3to15[which(is.na(admission_lab.3to15$HGB)),]$rID) 
na.rid.2 <- dplyr::union(admission_lab.3to15[which(is.na(admission_lab.3to15$CR)),]$rID, na.rid.1)
na.rid.3 <- dplyr::union(admission_lab.3to15[which(is.na(admission_lab.3to15$EGFR)),]$rID, admission_lab.3to15[which(is.na(admission_lab.3to15$K)),]$rID)
na.rid.4 <- dplyr::union(admission_lab.3to15[which(is.na(admission_lab.3to15$N_A)),]$rID, admission_lab.3to15[which(is.na(admission_lab.3to15$GLUCOSE)),]$rID)
na.rid.1 <- dplyr::union(na.rid.3, na.rid.4)
na.rid <- dplyr::union(na.rid.1, na.rid.2)

admission_lab.complete <- admission_lab.3to15[-which(admission_lab.3to15$rID %in% na.rid),]
```

# Reshape for traj model input

```{r}
patients_id <- unique(admission_lab.NArandom$rID)

generate_col_names <- function(measure_name, patients_id){
  col_names <- c()
  for (val in patients_id){
    col_names <- append(col_names, paste(measure_name, val, sep="_"))
  }
 return(col_names) 
}

measurement_df <- function(orginial_df, new_df, measure_name){
  col.names <- generate_col_names(measure_name, patients_id)
  names(new_df) <- col.names
  
  for (val in seq(1, length(unique(admission_lab.NArandom$rID)))){
    temp_c <- orginial_df[[measure_name]][which(orginial_df$rID == patients_id[val])]
    new_df[[col.names[val]]] <- c(temp_c, rep(NA, nrow(new_df)-length(temp_c)))
  }
  
  return(new_df)
}

change_col_names <- function(measure_name){
  col_names <- c()
  for (val in seq(1,15)){
    col_names <- append(col_names, paste(measure_name, val, sep="_"))
  }
  return(col_names)
}
```

*WBC*
```{r}
# wbc_ob <- complete.labs.3to15 %>% select(rID, WBC)
wbc.df <- data.frame(matrix(ncol = length(unique(admission_lab.NArandom$rID)), nrow = 15))

wbc.df <- measurement_df(orginial_df = admission_lab.NArandom, new_df = wbc.df, measure_name = 'WBC')

wbc.df.t <- transpose(wbc.df)

names(wbc.df.t) <- change_col_names('WBC')
```

*HGB*
```{r}
# wbc_ob <- complete.labs.3to15 %>% select(rID, WBC)
hgb.df <- data.frame(matrix(ncol = length(unique(admission_lab.NArandom$rID)), nrow = 15))

hgb.df <- measurement_df(orginial_df = admission_lab.NArandom, new_df = hgb.df, measure_name = 'HGB')

hgb.df.t <- transpose(hgb.df)

names(hgb.df.t) <- change_col_names('HGB')
```


*CR*
```{r}
# wbc_ob <- complete.labs.3to15 %>% select(rID, WBC)
cr.df <- data.frame(matrix(ncol = length(unique(admission_lab.NArandom$rID)), nrow = 15))

cr.df <- measurement_df(orginial_df = admission_lab.NArandom, new_df = cr.df, measure_name = 'CR')

cr.df.t <- transpose(cr.df)

names(cr.df.t) <- change_col_names('CR')
```

*EGFR*
```{r}
# wbc_ob <- complete.labs.3to15 %>% select(rID, WBC)
egfr.df <- data.frame(matrix(ncol = length(unique(admission_lab.NArandom$rID)), nrow = 15))

egfr.df <- measurement_df(orginial_df = admission_lab.NArandom, new_df = egfr.df, measure_name = 'EGFR')

egfr.df.t <- transpose(egfr.df)

names(egfr.df.t) <- change_col_names('EGFR')
```

*K*
```{r}
# wbc_ob <- complete.labs.3to15 %>% select(rID, WBC)
k.df <- data.frame(matrix(ncol = length(unique(admission_lab.NArandom$rID)), nrow = 15))

k.df <- measurement_df(orginial_df = admission_lab.NArandom, new_df = k.df, measure_name = 'K')

k.df.t <- transpose(k.df)

names(k.df.t) <- change_col_names('K')
```

*N_A*
```{r}
# wbc_ob <- complete.labs.3to15 %>% select(rID, WBC)
n_a.df <- data.frame(matrix(ncol = length(unique(admission_lab.NArandom$rID)), nrow = 15))

n_a.df <- measurement_df(orginial_df = admission_lab.NArandom, new_df = n_a.df, measure_name = 'N_A')

n_a.df.t <- transpose(n_a.df)

names(n_a.df.t) <- change_col_names('N_A')
```

*GLUCOSE*
```{r}
# wbc_ob <- complete.labs.3to15 %>% select(rID, WBC)
glucose.df <- data.frame(matrix(ncol = length(unique(admission_lab.NArandom$rID)), nrow = 15))

glucose.df <- measurement_df(orginial_df = admission_lab.NArandom, new_df = glucose.df, measure_name = 'GLUCOSE')

glucose.df.t <- transpose(glucose.df)

names(glucose.df.t) <- change_col_names('GLUCOSE')
```


## number of readmissions
```{r}
time.df <- data.frame(matrix(ncol = length(unique(admission_lab.NArandom$rID)), nrow = 15))
names(time.df) <- generate_col_names('T', patients_id)

for (val in seq(1, length(unique(admission_lab.NArandom$rID)))){
    time.df[[names(time.df)[val]]] <- seq(1,15)
}

time.df.t <- transpose(time.df)
names(time.df.t) <- change_col_names('T')

```

## DAYS_READMISSION
```{r}
days.df <- data.frame(matrix(ncol = length(unique(admission_lab.NArandom$rID)), nrow = 15))
days.df <- measurement_df(orginial_df = admission_lab.NArandom, new_df = days.df, measure_name = 'DAYS_READMISSION')

days.df.t <- transpose(days.df)

names(days.df.t) <- change_col_names('DAYS')
```


# Combine & Save datasets

```{r}
combined.labs.time <- cbind(wbc.df.t, hgb.df.t, cr.df.t, egfr.df.t, k.df.t, n_a.df.t, glucose.df.t, time.df.t)
write.xlsx(combined.labs.time, '~/Desktop/datasets/processed/GBTM_data/combined labs_vs_times.xlsx', col.names = TRUE, row.names = FALSE)
```

*biomarkers vs. # of readmission*
```{r}
combined.wbc.time <- cbind(wbc.df.t, time.df.t)
write.xlsx(combined.wbc.time, '~/Desktop/datasets/processed/GBTM_data/combined WBC_vs_times.xlsx', col.names = TRUE, row.names = FALSE)
```

```{r}
combined.hgb.time <- cbind(hgb.df.t, time.df.t)
write.xlsx(combined.hgb.time, '~/Desktop/datasets/processed/GBTM_data/combined HGB_vs_times.xlsx', col.names = TRUE, row.names = FALSE)
```

```{r}
combined.cr.time <- cbind(cr.df.t, time.df.t)
write.xlsx(combined.cr.time, '~/Desktop/datasets/processed/GBTM_data/combined CR_vs_times.xlsx', col.names = TRUE, row.names = FALSE)
```

```{r}
combined.egfr.time <- cbind(egfr.df.t, time.df.t)
write.xlsx(combined.egfr.time, '~/Desktop/datasets/processed/GBTM_data/combined EGFR_vs_times.xlsx', col.names = TRUE, row.names = FALSE)
```

```{r}
combined.k.time <- cbind(k.df.t, time.df.t)
write.xlsx(combined.k.time, '~/Desktop/datasets/processed/GBTM_data/combined K_vs_times.xlsx', col.names = TRUE, row.names = FALSE)
```

```{r}
combined.n_a.time <- cbind(n_a.df.t, time.df.t)
write.xlsx(combined.n_a.time, '~/Desktop/datasets/processed/GBTM_data/combined NA_vs_times.xlsx', col.names = TRUE, row.names = FALSE)
```

```{r}
combined.glucose.time <- cbind(glucose.df.t, time.df.t)
write.xlsx(combined.glucose.time, '~/Desktop/datasets/processed/GBTM_data/combined GLUCOSE_vs_times.xlsx', col.names = TRUE, row.names = FALSE)
```


# Missingness

```{r}
cat('WBC:', length(admission_lab.NArandom$WBC[which(is.na(admission_lab.NArandom$WBC))])/(dim(admission_lab.NArandom)[1])*100, "%\n")
cat('HGB:', length(admission_lab.NArandom$HGB[which(is.na(admission_lab.NArandom$HGB))])/(dim(admission_lab.NArandom)[1])*100, "%\n")
cat('CR:', length(admission_lab.NArandom$CR[which(is.na(admission_lab.NArandom$CR))])/(dim(admission_lab.NArandom)[1])*100, "%\n")
cat('EGFR:', length(admission_lab.NArandom$EGFR[which(is.na(admission_lab.NArandom$EGFR))])/(dim(admission_lab.NArandom)[1])*100, "%\n")
cat('K:', length(admission_lab.NArandom$K[which(is.na(admission_lab.NArandom$K))])/(dim(admission_lab.NArandom)[1])*100, "%\n")
cat('NA:', length(admission_lab.NArandom$N_A[which(is.na(admission_lab.NArandom$N_A))])/(dim(admission_lab.NArandom)[1])*100, "%\n")
cat('GLUCOSE:', length(admission_lab.NArandom$GLUCOSE[which(is.na(admission_lab.NArandom$GLUCOSE))])/(dim(admission_lab.NArandom)[1])*100, "%")
```


```{r}
ggplot(data = admission_lab.NArandom, aes(EGFR)) + geom_histogram()
```


