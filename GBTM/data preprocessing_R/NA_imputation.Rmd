---
title: "R Notebook"
output: html_notebook
---


```{r global_options, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
library(readxl)
library(openxlsx)
library(mice)
```


```{r}
df <- read_excel('~/Desktop/datasets/processed/Filtered Attributes Baseline.xlsx', sheet="Sheet 1")
```

```{r}
df.sub <- df %>% select(c("BMI", "PULSE", "BP_DIASTOLIC", "BP_SYSTOLIC"))
md.pattern(df.sub)
df.update <- df %>% select(-c("BMI", "PULSE", "BP_DIASTOLIC", "BP_SYSTOLIC"))
```

```{r}
tempData <- mice(df.sub, m=5, method = "pmm")
tempData$imp$BMI
completedData <- complete(tempData, 1)
df.update <- cbind(df.update, completedData)
```

```{r}
# xyplot(data=tempData, BMI~PULSE+BP_DIASTOLIC+BP_SYSTOLIC, pch=18, cex=1)
densityplot(tempData)
```
```{r}
write.xlsx(df.update, '~/Desktop/datasets/processed/GBTM_data/Filtered Baseline imputed.xlsx', col.names = TRUE, row.names = FALSE)
```

